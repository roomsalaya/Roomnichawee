import{r as n,j as t}from"./index-CdQMtJ4V.js";import{y as F,x as w,F as U,o as Y,n as b}from"./Footer-BrrzdiQ6.js";import{N as C,S as E,a as p}from"./Navbar-Da7eFCuP.js";import{F as L}from"./Table-BFXHAD0s.js";import"./index-Kq734cKG.js";import"./Dropdown-3pUkFW79.js";import"./index-B3EBX0Jl.js";import"./index-CFT2Eiuw.js";import"./EyeOutlined-B4iqqBsu.js";const{Option:N}=p,q=()=>{const[i,x]=n.useState([]),[f,c]=n.useState(!0),[l,u]=n.useState(null),d=F(),m=w(),[y,v]=n.useState(null);n.useEffect(()=>{(async()=>{c(!0);try{const o=m.currentUser;if(o){const s=o.email,h=(s==null?void 0:s.split("@")[0])||null;v(h);const j=Y(d,"invoices"),k=(await b(j)).docs.map(a=>a.data()).filter(a=>a.room===h);x(k)}}catch(o){console.error("Error fetching invoices data: ",o)}finally{c(!1)}})()},[d,m]);const g=e=>{u(e)},r={มกราคม:1,กุมภาพันธ์:2,มีนาคม:3,เมษายน:4,พฤษภาคม:5,มิถุนายน:6,กรกฎาคม:7,สิงหาคม:8,กันยายน:9,ตุลาคม:10,พฤศจิกายน:11,ธันวาคม:12},I=l?i.filter(e=>e.year===l-543).sort((e,o)=>(r[e.month]||0)-(r[o.month]||0)):i.sort((e,o)=>(r[e.month]||0)-(r[o.month]||0)),S=[{title:"ห้อง",dataIndex:"room",key:"room"},{title:"เดือนที่แจ้งหนี้",dataIndex:"month",key:"month"},{title:"ปี (พ.ศ.)",dataIndex:"year",key:"year",render:e=>e+543},{title:"ค่าเช่า (บาท)",dataIndex:"rent",key:"rent"},{title:"ค่าน้ำ (บาท)",dataIndex:"water",key:"water"},{title:"ค่าไฟ (บาท)",dataIndex:"electricity",key:"electricity"},{title:"ค่าปรับ (บาท)",dataIndex:"fine",key:"fine"},{title:"ยอดรวม (บาท)",dataIndex:"total",key:"total"},{title:"สถานะห้อง",dataIndex:"roomStatus",key:"roomStatus"},{title:"ดาวน์โหลด PDF",dataIndex:"pdfUrl",key:"pdfUrl",render:e=>e?t.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",children:"ดาวน์โหลด"}):"ไม่มีไฟล์"}];return t.jsxs(t.Fragment,{children:[t.jsx(C,{}),t.jsxs("div",{className:"sent-invoices-container",children:[t.jsx("h3",{children:"บิลแจ้งหนี้"}),f?t.jsx(E,{size:"large"}):y?t.jsxs(t.Fragment,{children:[t.jsx(p,{style:{width:200,marginBottom:20},placeholder:"เลือกปี",onChange:g,children:Array.from({length:11},(e,o)=>2567+o).map(e=>t.jsx(N,{value:e,children:e},e))}),t.jsx(L,{dataSource:I,columns:S,rowKey:"room",pagination:{pageSize:10}})]}):t.jsx("p",{children:"กรุณาล็อกอินเพื่อดูข้อมูล"})]}),t.jsx(U,{})]})};export{q as default};
