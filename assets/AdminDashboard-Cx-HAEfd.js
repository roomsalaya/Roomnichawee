import{r as o,j as e}from"./index-BHdp83b0.js";import{c as b,e as E,R as F,C as p,F as N,j as R,k as I}from"./Footer-CMoXQgNy.js";import{N as D,S as P,L as f}from"./Navbar-CeMW9FJG.js";import{C as x}from"./index-BtV11wQ_.js";import{P as A}from"./progress-VVKg1NsH.js";import{I as Q}from"./index-BMLQu8z4.js";import{s as k}from"./index-13Roxwsq.js";import"./EyeOutlined--npR9_tm.js";const O=()=>{const[l,j]=o.useState(0),[g,d]=o.useState(!1),[h,C]=o.useState([]),[S,n]=o.useState([]),[L,U]=o.useState(""),v=b(),u=E(),a=v.currentUser;o.useEffect(()=>{a!=null&&a.uid&&(async()=>{d(!0);try{const s=R(u,"users"),c=await I(s),t=[];c.forEach(m=>{const i=m.data();t.push({id:m.id,name:i.name||"ไม่ทราบชื่อ",phone:i.phone||"ไม่ระบุเบอร์โทร",room:i.room||"ไม่ระบุห้อง"})}),C(t),n(t),j(t.length)}catch(s){console.error("Error fetching user data:",s),k.error("เกิดข้อผิดพลาดในการดึงข้อมูล")}finally{d(!1)}})()},[a,u]);const w=r=>{const s=r.target.value.trim();if(U(s),s){const c=h.filter(t=>t.phone.toLowerCase().includes(s.toLowerCase())||t.room.toLowerCase().includes(s.toLowerCase()));n(c)}else n(h)},y=l/100*100;return e.jsxs(e.Fragment,{children:[e.jsx(D,{}),e.jsxs("div",{className:"dashboard-container",children:[e.jsx("h2",{children:"แดชบอร์ด"}),g?e.jsx("div",{className:"loading-container",children:e.jsx(P,{size:"large"})}):e.jsxs(F,{gutter:[16,16],children:[e.jsx(p,{span:24,children:e.jsx(x,{title:"จำนวนผู้ใช้",children:e.jsx(A,{percent:y,format:()=>`${l} ห้อง`,status:"active"})})}),e.jsxs(p,{span:24,children:[e.jsx(Q,{placeholder:"ค้นหาเบอร์โทรหรือห้อง",value:L,onChange:w,className:"search-input"}),e.jsx(x,{title:"ผลการค้นหา",children:e.jsx(f,{bordered:!0,dataSource:S,renderItem:r=>e.jsxs(f.Item,{children:[r.name," - ",r.phone," - ห้อง: ",r.room]})})})]})]})]}),e.jsx(N,{})]})};export{O as default};
