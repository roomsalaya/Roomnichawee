import{p as a,q as e,N as S,S as w,F as y,y as r,M as F,O as N,P as R,Q as C,T as f,t as j,v as b}from"./index-C3gF8JJM.js";function L(){const[o,l]=a.useState(""),[c,u]=a.useState(""),[i,m]=a.useState(null),[d,g]=a.useState(!1),[v,p]=a.useState(!1),D=async t=>{t.preventDefault();const n=o.trim(),h=c.trim();if(!n||!h){r.warning("กรุณากรอกข้อมูลให้ครบถ้วน");return}g(!0),p(!0);try{let s="";if(i){const x=F(N,`maintenance/${i.name}`);await R(x,i),s=await C(x)}await f(j(b,"maintenanceReports"),{issueDescription:n,location:h,imageUrl:s,timestamp:new Date}),await f(j(b,"notifications"),{userId:"adminUserId",message:`แจ้งรายการแซ่มแซม: ${n}`,timestamp:new Date}),r.success("บันทึกข้อมูลสำเร็จ"),l(""),u(""),m(null),document.getElementById("imageInput").value=""}catch(s){console.error("Error saving maintenance report:",s),r.error("เกิดข้อผิดพลาดในการบันทึกข้อมูล")}finally{g(!1),p(!1)}},I=t=>{t.target.files&&t.target.files[0]&&m(t.target.files[0])};return e.jsxs("div",{className:"wrapper",children:[e.jsx(S,{}),v&&e.jsx("div",{className:"loading-container",children:e.jsx(w,{size:"large"})}),e.jsx("h3",{children:"แจ้งซ่อมแซม"}),e.jsxs("form",{onSubmit:D,className:"maintenance-form",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"issueDescription",children:"รายละเอียดปัญหา :"}),e.jsx("textarea",{id:"issueDescription",value:o,onChange:t=>l(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",children:"สถานที่ :"}),e.jsx("input",{id:"location",type:"text",value:c,onChange:t=>u(t.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"imageInput",children:"รูปภาพปัญหา (ถ้ามี):"}),e.jsx("input",{id:"imageInput",type:"file",accept:"image/*",onChange:I})]}),e.jsx("button",{type:"submit",disabled:d,children:d?"กำลังบันทึก...":"บันทึก"})]}),e.jsx(y,{})]})}export{L as default};
