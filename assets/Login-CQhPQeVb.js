import{p as i,I as p,c as j,z as w,q as e,A as h,B as I,D as v,E as b,F as y,G as F,H as l,w as S,v as k,J as E,y as n}from"./index-DvTBtECc.js";import{F as a}from"./index-BO_1syaD.js";var V={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},z=function(t,r){return i.createElement(p,j({},t,{ref:r,icon:V}))},L=i.forwardRef(z);const D=()=>{const[c,t]=i.useState(!1),[r]=a.useForm(),d=w();i.useEffect(()=>{const s=localStorage.getItem("email"),o=localStorage.getItem("password");s&&r.setFieldsValue({email:s}),o&&r.setFieldsValue({password:o})},[r]);const x=async s=>{t(!0);try{const f=(await F(l,s.email,s.password)).user,g=S(k,"users",f.uid),m=await E(g);if(m.exists()){const u=m.data();s.remember?(localStorage.setItem("email",s.email),localStorage.setItem("password",s.password)):(localStorage.removeItem("email"),localStorage.removeItem("password")),u.role==="admin"?d("/admindashboard"):u.role==="user"?d("/Profile"):(n.error("บทบาทของผู้ใช้ไม่ถูกต้อง"),await l.signOut())}else n.error("ไม่พบข้อมูลผู้ใช้ในระบบ"),await l.signOut()}catch{n.error("การล็อกอินล้มเหลว กรุณาตรวจสอบข้อมูลประจำตัวของคุณ.")}finally{t(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"login-container",children:[" ",e.jsx("h2",{children:"ล็อกอิน"}),e.jsxs(a,{form:r,name:"login",initialValues:{remember:!0},onFinish:x,children:[e.jsx(a.Item,{name:"email",rules:[{required:!0,message:"กรุณากรอกอีเมลของคุณ!"}],children:e.jsx(h,{prefix:e.jsx(I,{}),placeholder:"อีเมล",type:"email"})}),e.jsx(a.Item,{name:"password",rules:[{required:!0,message:"กรุณากรอกรหัสผ่านของคุณ!"}],children:e.jsx(h.Password,{prefix:e.jsx(L,{}),placeholder:"รหัสผ่าน"})}),e.jsx(a.Item,{children:e.jsx(a.Item,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(v,{children:"จำรหัสผ่าน"})})}),e.jsx(a.Item,{children:e.jsx(b,{type:"primary",htmlType:"submit",loading:c,block:!0,children:"ล็อกอิน"})})]})]}),e.jsx(y,{})]})};export{D as default};
