import{r as n,j as t}from"./index-CZo4XsUW.js";import{e as w,c as F,F as b,j as C,k as P,aa as Y}from"./Footer-BAcQt4i0.js";import{N as D,S as N,a as h}from"./Navbar-BTIGLGfH.js";import{F as U}from"./Table-_YPA9AVS.js";import"./index-mXGRjk8y.js";import"./index-B7m_4dvp.js";import"./EyeOutlined-D9cS-oyN.js";const{Option:A}=h,M=()=>{const[p,f]=n.useState([]),[x,i]=n.useState(!0),[s,u]=n.useState(new Date().getFullYear()+543),c=w(),l=F(),[v,g]=n.useState(null);n.useEffect(()=>{(async()=>{i(!0);try{const o=l.currentUser;if(o){const a=o.email,m=(a==null?void 0:a.split("@")[0])||null;g(m);const j=C(c,"invoices"),k=(await P(j)).docs.map(r=>r.data()).filter(r=>r.room===m);f(k)}}catch(o){console.error("Error fetching invoices data: ",o)}finally{i(!1)}})()},[c,l]);const y=e=>{u(e)},d={มกราคม:1,กุมภาพันธ์:2,มีนาคม:3,เมษายน:4,พฤษภาคม:5,มิถุนายน:6,กรกฎาคม:7,สิงหาคม:8,กันยายน:9,ตุลาคม:10,พฤศจิกายน:11,ธันวาคม:12},I=p.filter(e=>!s||e.year===s-543).sort((e,o)=>(d[e.month]||0)-(d[o.month]||0)),S=[{title:"ห้อง",dataIndex:"room",key:"room"},{title:"เดือนที่แจ้งหนี้",dataIndex:"month",key:"month"},{title:"ปี (พ.ศ.)",dataIndex:"year",key:"year",render:e=>e+543},{title:"ค่าเช่า (บาท)",dataIndex:"rent",key:"rent"},{title:"ค่าน้ำ (บาท)",dataIndex:"water",key:"water"},{title:"ค่าไฟ (บาท)",dataIndex:"electricity",key:"electricity"},{title:"ค่าปรับ (บาท)",dataIndex:"fine",key:"fine"},{title:"ยอดรวม (บาท)",dataIndex:"total",key:"total"},{title:"สถานะห้อง",dataIndex:"roomStatus",key:"roomStatus"},{title:"ดาวน์โหลด PDF",dataIndex:"pdfUrl",key:"pdfUrl",render:e=>e?t.jsx(Y,{title:"กดเปิดลิงก์ในแท็บใหม่หากไม่สามารถดาวน์โหลดได้",children:t.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",onClick:o=>{/iPad|iPhone|iPod/.test(navigator.userAgent)&&(window.open(e,"_blank"),o.preventDefault())},children:"ดาวน์โหลด"})}):"ไม่มีไฟล์"}];return t.jsxs(t.Fragment,{children:[t.jsx(D,{}),t.jsxs("div",{className:"sent-invoices-container",children:[t.jsx("h3",{children:"บิลแจ้งหนี้"}),x?t.jsx(N,{size:"large"}):v?t.jsxs(t.Fragment,{children:[t.jsx(h,{style:{width:200,marginBottom:20},placeholder:"เลือกปี",onChange:y,value:s||void 0,allowClear:!0,children:Array.from({length:11},(e,o)=>2567+o).map(e=>t.jsx(A,{value:e,children:e},e))}),t.jsx(U,{dataSource:I,columns:S,rowKey:"room",pagination:{pageSize:10},className:"table"})]}):t.jsx("p",{children:"กรุณาล็อกอินเพื่อดูข้อมูล"})]}),t.jsx(b,{})]})};export{M as default};
