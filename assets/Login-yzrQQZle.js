import{r as i,u as g,j as e}from"./index-CUqas5L9.js";import{I as j,c as I,R as w,B as v,F as b,t as F,v as l,q as S,p as y,w as k}from"./Footer-CyUfZN7b.js";import{F as r}from"./index-Cjcp2fXo.js";import{I as h}from"./index-B3JPUSpt.js";import{C as V}from"./index-Bc0MRbJX.js";import{s as n}from"./index-BdC4Iwiu.js";import"./EyeOutlined-BnnNnPAB.js";var E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},L=function(t,a){return i.createElement(j,I({},t,{ref:a,icon:E}))},O=i.forwardRef(L);const D=()=>{const[c,t]=i.useState(!1),[a]=r.useForm(),m=g();i.useEffect(()=>{const s=localStorage.getItem("email"),o=localStorage.getItem("password");s&&a.setFieldsValue({email:s}),o&&a.setFieldsValue({password:o})},[a]);const p=async s=>{t(!0);try{const f=(await F(l,s.email,s.password)).user,x=S(y,"users",f.uid),d=await k(x);if(d.exists()){const u=d.data();s.remember?(localStorage.setItem("email",s.email),localStorage.setItem("password",s.password)):(localStorage.removeItem("email"),localStorage.removeItem("password")),u.role==="admin"?m("/admindashboard"):u.role==="user"?m("/Profile"):(n.error("บทบาทของผู้ใช้ไม่ถูกต้อง"),await l.signOut())}else n.error("ไม่พบข้อมูลผู้ใช้ในระบบ"),await l.signOut()}catch{n.error("การล็อกอินล้มเหลว กรุณาตรวจสอบข้อมูลประจำตัวของคุณ.")}finally{t(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"login-container",children:[" ",e.jsx("h2",{children:"ล็อกอิน"}),e.jsxs(r,{form:a,name:"login",initialValues:{remember:!0},onFinish:p,children:[e.jsx(r.Item,{name:"email",rules:[{required:!0,message:"กรุณากรอกอีเมลของคุณ!"}],children:e.jsx(h,{prefix:e.jsx(w,{}),placeholder:"อีเมล",type:"email"})}),e.jsx(r.Item,{name:"password",rules:[{required:!0,message:"กรุณากรอกรหัสผ่านของคุณ!"}],children:e.jsx(h.Password,{prefix:e.jsx(O,{}),placeholder:"รหัสผ่าน"})}),e.jsx(r.Item,{children:e.jsx(r.Item,{name:"remember",valuePropName:"checked",noStyle:!0,children:e.jsx(V,{children:"จำรหัสผ่าน"})})}),e.jsx(r.Item,{children:e.jsx(v,{type:"primary",htmlType:"submit",loading:c,block:!0,children:"ล็อกอิน"})})]})]}),e.jsx(b,{})]})};export{D as default};
